<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>CalendarService</title><script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script><script src="https://unpkg.com/@babel/standalone/babel.min.js"></script><script src="./build/entry.js"></script><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous"><link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css"><link type="text/css" rel="stylesheet" href="styles/app.min.css"><link type="text/css" rel="stylesheet" href="styles/iframe.css"><link type="text/css" rel="stylesheet" href=""><script async defer src="https://buttons.github.io/buttons.js"></script></head><body class="layout small-header"><div id="stickyNavbarOverlay"></div><div class="top-nav"><div class="inner"><a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false"><span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span></a><div class="logo"></div><div class="menu"><div class="navigation"><a href="index.html" class="link" >Documentation </a></div></div></div></div><div id="main"><div class="sidebar " id="sidebarNav" ><nav><h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Classes</h3><ul><li><a href="CalendarService.html">CalendarService</a></li><li><a href="CreationError.html">CreationError</a></li><li><a href="FetchError.html">FetchError</a></li><li><a href="Log.html">Log</a></li><li><a href="ParameterError.html">ParameterError</a></li><li><a href="SheetInterpreter.html">SheetInterpreter</a></li></ul><h3>Interfaces</h3><ul><li><a href="IRuleTable.html">IRuleTable</a></li></ul><h3>Global</h3><ul><li><a href="global.html#CalFactory">CalFactory</a></li></ul></div></nav></div><div class="core" id="main-content-wrapper"><div class="content"><header class="page-title"><p>Class</p><h1>CalendarService</h1></header><section><header><h2><span class="attribs"><span class="type-signature"></span></span>CalendarService<span class="signature">()</span><span class="type-signature"></span></h2><div class="class-description"><p>The <code>CalendarService</code>class is a wrapper service for Google Calendar API. Handles Calendar , CalendarApp and AclRule class.</p></div></header><article><div class="container-overview"><div class='vertical-section'><div class="members"><div class="member"><div class=name><span class="tag">Constructor</span></div><h4 class="name" id="CalendarService"><a class="href-link" href="#CalendarService">#</a><span class="code-name">new CalendarService<span class="signature">()</span><span class="type-signature"></span></span></h4><dl class="details"><p class="tag-source"><a href="CalendarService.ts.html" class="button">View Source</a><span><a href="CalendarService.ts.html">CalendarService.ts</a>, <a href="CalendarService.ts.html#line11">line 11</a></span></p></dl></div></div></div></div><h3 class="subsection-title">Classes</h3><dl><dt><a href="CalendarService.html">CalendarService</a></dt><dd></dd></dl><div class='vertical-section'><h1>Methods</h1><div class="members"><div class="member"><h4 class="name" id="createAclRule"><a class="href-link" href="#createAclRule">#</a><span class="code-name">createAclRule<span class="signature">(calendar, userMailAddress, role)</span><span class="type-signature">&rarr;{AclRule}</span></span></h4><p class="summary">Creates a new ACL rule for a user when the same rule doesn't exist.</p><div class="description"><p>Creates a new ACL rule for a user when the same rule doesn't exist.</p></div><h5>Parameters:</h5><div class="table-container"><table class="params table"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr class="deep-level-0"><td class="name"><code>calendar</code></td><td class="type"><code class="param-type">string</code>|<code class="param-type">CalendarWithRules</code></td><td class="description last"><p>The Calendar object or calendarId to which the rule to insert.</p></td></tr><tr class="deep-level-0"><td class="name"><code>userMailAddress</code></td><td class="type"><code class="param-type">string</code></td><td class="description last"><p>The email address of the user to add to the ACL.</p></td></tr><tr class="deep-level-0"><td class="name"><code>role</code></td><td class="type"><code class="param-type"><a href="global.html#role">role</a></code></td><td class="description last"><p>The role of the user.</p></td></tr></tbody></table></div><dl class="details"><p class="tag-source"><a href="CalendarService.ts.html" class="button">View Source</a><span><a href="CalendarService.ts.html">CalendarService.ts</a>, <a href="CalendarService.ts.html#line334">line 334</a></span></p></dl><div class='columns method-parameter'><div class="column is-2"><label>Throws:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>If failed to create a new ACL rule.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type"><a href="FetchError.html">FetchError</a></code></div></div><div class="columns"><div class='param-desc column is-7'><p>If other error occurred.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type">Error</code></div></div></div></div><div class='columns method-parameter'><div class="column is-2"><label>Returns:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>The new ACL rule.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type">AclRule</code></div></div></div></div></div><div class="member"><h4 class="name" id="createCalendarWithName"><a class="href-link" href="#createCalendarWithName">#</a><span class="code-name">createCalendarWithName<span class="signature">(calendarName)</span><span class="type-signature">&rarr;{Calendar}</span></span></h4><p class="summary">Ges a calendar by name.</p><div class="description"><p>Ges a calendar by name. If not exist.</p></div><h5>Parameters:</h5><div class="table-container"><table class="params table"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr class="deep-level-0"><td class="name"><code>calendarName</code></td><td class="type"><code class="param-type">string</code></td><td class="description last"><p>The name of the calendar to create.</p></td></tr></tbody></table></div><dl class="details"><p class="tag-source"><a href="CalendarService.ts.html" class="button">View Source</a><span><a href="CalendarService.ts.html">CalendarService.ts</a>, <a href="CalendarService.ts.html#line314">line 314</a></span></p></dl><div class='columns method-parameter'><div class="column is-2"><label>Throws:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>If the creation try failed.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type"><a href="CreationError.html">CreationError</a></code></div></div></div></div><div class='columns method-parameter'><div class="column is-2"><label>Returns:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>The newly created calendar.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type">Calendar</code></div></div></div></div></div><div class="member"><h4 class="name" id="fetchAllCalendars"><a class="href-link" href="#fetchAllCalendars">#</a><span class="code-name">fetchAllCalendars<span class="signature">()</span><span class="type-signature">&rarr;{Array.&lt;CalendarWithRules>}</span></span></h4><p class="summary">Returns all the calendars from the Google Calendar API.</p><div class="description"><p>Returns all the calendars from the Google Calendar API.</p></div><dl class="details"><p class="tag-source"><a href="CalendarService.ts.html" class="button">View Source</a><span><a href="CalendarService.ts.html">CalendarService.ts</a>, <a href="CalendarService.ts.html#line31">line 31</a></span></p></dl><div class='columns method-parameter'><div class="column is-2"><label>Throws:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>When failed to fetch calendar data.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type"><a href="FetchError.html">FetchError</a></code></div></div></div></div><div class='columns method-parameter'><div class="column is-2"><label>Returns:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>An array of calendars.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type">Array.&lt;CalendarWithRules></code></div></div></div></div></div><div class="member"><h4 class="name" id="getAclRule"><a class="href-link" href="#getAclRule">#</a><span class="code-name">getAclRule<span class="signature">(_calendar, userMailAddress)</span><span class="type-signature">&rarr;{AclRule|undefined}</span></span></h4><p class="summary"><p>Get the ACL rule for the specified user</p>.</p><div class="description"><p>Get the ACL rule for the specified user</p></div><h5>Parameters:</h5><div class="table-container"><table class="params table"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr class="deep-level-0"><td class="name"><code>_calendar</code></td><td class="type"><code class="param-type">string</code>|<code class="param-type">CalendarWithRules</code></td><td class="description last"><p>The ID of the calendar to which the ACL rule belongs.</p></td></tr><tr class="deep-level-0"><td class="name"><code>userMailAddress</code></td><td class="type"><code class="param-type">string</code></td><td class="description last"><p>The email address of the target user.</p></td></tr></tbody></table></div><dl class="details"><p class="tag-source"><a href="CalendarService.ts.html" class="button">View Source</a><span><a href="CalendarService.ts.html">CalendarService.ts</a>, <a href="CalendarService.ts.html#line306">line 306</a></span></p></dl><div class='columns method-parameter'><div class="column is-2"><label>Returns:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>There's three cases.</p><ol><li>When the calendar has a rule for the user (AclRule object), this returns that rule.</li><li>When not, it returns the rule (AclRule object) that says the user has no permission.</li><li>In other case (like the calender is totally new and has no rules for any users), this returns <code>undefined</code>.</li></ol></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type">AclRule</code>|<code class="param-type">undefined</code></div></div></div></div></div><div class="member"><h4 class="name" id="getAllCalendars"><a class="href-link" href="#getAllCalendars">#</a><span class="code-name">getAllCalendars<span class="signature">()</span><span class="type-signature">&rarr;{Array.&lt;CalendarWithRules>}</span></span></h4><p class="summary">Returns all the calendars from the Google Calendar API.</p><div class="description"><p>Returns all the calendars from the Google Calendar API.Note that they're in memory cashed.To get the newest online state, use <code>renew</code>method.</p></div><dl class="details"><p class="tag-source"><a href="CalendarService.ts.html" class="button">View Source</a><span><a href="CalendarService.ts.html">CalendarService.ts</a>, <a href="CalendarService.ts.html#line279">line 279</a></span></p></dl><div class='columns method-parameter'><div class="column is-2"><label>Returns:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>An array of calendars.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type">Array.&lt;CalendarWithRules></code></div></div></div></div></div><div class="member"><h4 class="name" id="getCalendarById"><a class="href-link" href="#getCalendarById">#</a><span class="code-name">getCalendarById<span class="signature">(id)</span><span class="type-signature">&rarr;{CalendarWithRules}</span></span></h4><p class="summary">Gets the calendar with given id string.</p><div class="description"><p>Gets the calendar with given id string.</p></div><h5>Parameters:</h5><div class="table-container"><table class="params table"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr class="deep-level-0"><td class="name"><code>id</code></td><td class="type"><code class="param-type">string</code></td><td class="description last"><p>The id of the calendar to get.</p></td></tr></tbody></table></div><dl class="details"><p class="tag-source"><a href="CalendarService.ts.html" class="button">View Source</a><span><a href="CalendarService.ts.html">CalendarService.ts</a>, <a href="CalendarService.ts.html#line287">line 287</a></span></p></dl><div class='columns method-parameter'><div class="column is-2"><label>Throws:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>If the calendar is not found.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type"><a href="FetchError.html">FetchError</a></code></div></div></div></div><div class='columns method-parameter'><div class="column is-2"><label>Returns:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>The calendar object.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type">CalendarWithRules</code></div></div></div></div></div><div class="member"><h4 class="name" id="getCalendarByName"><a class="href-link" href="#getCalendarByName">#</a><span class="code-name">getCalendarByName<span class="signature">(name)</span><span class="type-signature">&rarr;{CalendarWithRules}</span></span></h4><p class="summary">Gets the calendar with the given name.</p><div class="description"><p>Gets the calendar with the given name.</p></div><h5>Parameters:</h5><div class="table-container"><table class="params table"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr class="deep-level-0"><td class="name"><code>name</code></td><td class="type"><code class="param-type">string</code></td><td class="description last"><p>The name of the calendar to get.</p></td></tr></tbody></table></div><dl class="details"><p class="tag-source"><a href="CalendarService.ts.html" class="button">View Source</a><span><a href="CalendarService.ts.html">CalendarService.ts</a>, <a href="CalendarService.ts.html#line295">line 295</a></span></p></dl><div class='columns method-parameter'><div class="column is-2"><label>Throws:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>If the calendar is not found.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type"><a href="FetchError.html">FetchError</a></code></div></div></div></div><div class='columns method-parameter'><div class="column is-2"><label>Returns:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>The calendar object.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type">CalendarWithRules</code></div></div></div></div></div><div class="member"><h4 class="name" id="getCount"><a class="href-link" href="#getCount">#</a><span class="code-name">getCount<span class="signature">()</span><span class="type-signature"></span></span></h4><p class="summary"><p>Returns the value of the API count (<strong>not so accurate</strong>)</p>.</p><div class="description"><p>Returns the value of the API count (<strong>not so accurate</strong>)</p></div><dl class="details"><p class="tag-source"><a href="CalendarService.ts.html" class="button">View Source</a><span><a href="CalendarService.ts.html">CalendarService.ts</a>, <a href="CalendarService.ts.html#line340">line 340</a></span></p></dl><div class='columns method-parameter'><div class="column is-2"><label>Returns:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>The number of elements in the list.</p></div></div></div></div></div><div class="member"><h4 class="name" id="getOrCreateCalendarWithName"><a class="href-link" href="#getOrCreateCalendarWithName">#</a><span class="code-name">getOrCreateCalendarWithName<span class="signature">(calendarName)</span><span class="type-signature">&rarr;{Calendar}</span></span></h4><p class="summary">Creates a calendar with the given name if it doesn't already exist.</p><div class="description"><p>Creates a calendar with the given name if it doesn't already exist.</p></div><h5>Parameters:</h5><div class="table-container"><table class="params table"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr class="deep-level-0"><td class="name"><code>calendarName</code></td><td class="type"><code class="param-type">string</code></td><td class="description last"><p>The name of the calendar to create.</p></td></tr></tbody></table></div><dl class="details"><p class="tag-source"><a href="CalendarService.ts.html" class="button">View Source</a><span><a href="CalendarService.ts.html">CalendarService.ts</a>, <a href="CalendarService.ts.html#line322">line 322</a></span></p></dl><div class='columns method-parameter'><div class="column is-2"><label>Throws:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>If the creation try failed.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type"><a href="CreationError.html">CreationError</a></code></div></div></div></div><div class='columns method-parameter'><div class="column is-2"><label>Returns:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>The newly created calendar OR the existing calendar.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type">Calendar</code></div></div></div></div></div><div class="member"><h4 class="name" id="renew"><a class="href-link" href="#renew">#</a><span class="code-name">renew<span class="signature">()</span><span class="type-signature">&rarr;{Array.&lt;CalendarWithRules>}</span></span></h4><p class="summary">Fetches all the calendars from the Google Calendar API.</p><div class="description"><p>Fetches all the calendars from the Google Calendar API.</p></div><dl class="details"><p class="tag-source"><a href="CalendarService.ts.html" class="button">View Source</a><span><a href="CalendarService.ts.html">CalendarService.ts</a>, <a href="CalendarService.ts.html#line271">line 271</a></span></p></dl><div class='columns method-parameter'><div class="column is-2"><label>Returns:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>The calendars array.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type">Array.&lt;CalendarWithRules></code></div></div></div></div></div><div class="member"><h4 class="name" id="toJson"><a class="href-link" href="#toJson">#</a><span class="code-name">toJson<span class="signature">()</span><span class="type-signature">&rarr;{string}</span></span></h4><p class="summary"><p>To json</p>.</p><div class="description"><p>To json</p></div><dl class="details"><p class="tag-source"><a href="CalendarService.ts.html" class="button">View Source</a><span><a href="CalendarService.ts.html">CalendarService.ts</a>, <a href="CalendarService.ts.html#line257">line 257</a></span></p></dl><div class='columns method-parameter'><div class="column is-2"><label>Returns:</label></div><div class="column is-10"><div class="columns"><div class='param-desc column is-7'><p>The json string.</p></div><div class='column is-5 has-text-left'><label>Type: </label><code class="param-type">string</code></div></div></div></div></div></div></div></article></section></div><footer class="footer"><div class="content has-text-centered"><p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a></p><p class="sidebar-created-by"><a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a>provided with <i class="fas fa-heart"></i>by <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a></p></div></footer></div><div id="side-nav" class="side-nav"></div></div><script src="scripts/app.min.js"></script><script>PR.prettyPrint();</script><script src="scripts/linenumber.js"></script></body></html>
